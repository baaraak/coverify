!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t(e.Snuggle={},e.React)}(this,function(e,t){"use strict";function n(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);i.length>r;r++)0>t.indexOf(i[r])&&(n[i[r]]=e[i[r]]);return n}var i=()=>Math.random().toString(36).substring(2);const r=(e=>t=>{const n=t;e.forEach(e=>Object.prototype.hasOwnProperty.call(n,e)&&delete n[e]);return n})(["rowGap","columnWidth","uniqueid"]);class o extends t.PureComponent{constructor(e){super(e),this.gridId=null,this.reposition=!1,this.elements=[],this.grid=null,this.getRef=(e=>{e&&e.firstElementChild&&this.elements.push(e)}),this.setValues=(()=>{const{rowGap:rowGap=0}=this.props;if(0===this.elements.length)return null;this.elements.forEach(e=>{const t=e;if(t&&t.firstElementChild){const e=t.firstElementChild,n=e.getBoundingClientRect().height,i=Math.ceil((n+rowGap)/rowGap);t.style.gridRowEnd=`span ${i}`}return null});this.reposition||(window.requestAnimationFrame(this.setValues),this.reposition=!0)}),this.onLoadImages=(()=>{if(this.grid){const e=this.grid.getElementsByTagName("img");Array.from(e).forEach(e=>{const t=e;t.onload=(()=>{this.setValues()})})}}),this.createGridStyle=(()=>{const{rowGap:rowGap=0,columnWidth:columnWidth=0}=this.props;return`\n      <style>\n        .${this.gridId} {\n          display: grid;\n          grid-gap: ${rowGap}px;\n          grid-template-columns: repeat(auto-fill, minmax(${columnWidth}px, 1fr));\n        }\n      </style>`}),this.gridId=`snuggle--${e.uniqueid||i()}`,e.innerRef.current={resize:this.setValues}}componentDidMount(){this.setValues(),this.onLoadImages()}componentDidUpdate(){this.setValues()}render(){const e=this.props,{children:children,item:item=t.createElement("div"),container:container=t.createElement("div"),innerRef:innerRef}=e,o=n(e,["children","item","container","innerRef"]);if(!(t.Children.count(children)>0))return null;const s=e=>{this.getRef(e)},c=e=>{this.grid=e},l=t.Children.map(children,e=>{const n=r(Object.assign({},item.props,{key:i(),ref:s}));if(item)return t.createElement(item.type,n,e);return null}),u=r(Object.assign({},container.props,o,{className:`${this.gridId} ${container.props.className||""}`,ref:c}));return t.createElement(t.Fragment,null,t.createElement("div",{dangerouslySetInnerHTML:{__html:this.createGridStyle()}}),t.createElement(container.type,u,l))}}o.defaultProps={columnWidth:250,container:t.createElement("div"),item:t.createElement("div"),rowGap:20,uniqueid:""};var s=t.forwardRef((e,n)=>t.createElement(o,Object.assign({innerRef:n},e)));e.default=s,Object.defineProperty(e,"__esModule",{value:!0})});
